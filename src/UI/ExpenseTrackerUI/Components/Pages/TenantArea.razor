@page "/tenants"
@attribute [Authorize(Roles = "SystemAdmin")]
@rendermode InteractiveServer

@using ExpenseTrackerUI.Services.Tenant
@using ExpenseTrackerUI.Components.Shared
@inject TenantService TenantService

<h3>Tenant Management</h3>

<div class="mb-3">
    <button class="btn btn-primary" @onclick="ShowCreateModal">
        <span class="bi bi-building-add"></span> Create Tenant
    </button>
</div>

@if (successMessage != null)
{
    <div class="alert alert-success alert-dismissible fade show" role="alert">
        @successMessage
        <button type="button" class="btn-close" @onclick="() => successMessage = null"></button>
    </div>
}

<p class="text-muted">Tenant listing coming soon...</p>

<CreateTenantModal @ref="createModal" OnTenantCreated="HandleTenantCreated" />

@code {
    private CreateTenantModal? createModal;
    private string? successMessage;

    private async Task ShowCreateModal()
    {
        if (createModal != null)
        {
            await createModal.Show();
        }
    }

    private void HandleTenantCreated(CreateTenantResponse tenant)
    {
        successMessage = $"Tenant '{tenant.Name}' created successfully!";
        StateHasChanged();
    }
}
